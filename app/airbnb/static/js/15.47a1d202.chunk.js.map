{"version":3,"sources":["scripts/views/xinyuandan/index.js","assets/xinyuandan.jpg","utils/history.js","utils/axios.js"],"names":["img","require","Xinyuandan","goHouse","id","sessionStorage","houseid","history","push","goStory","storyid","state","tabs","title","name","sub","housesId","storiesId","houses","stories","show","msgShow","scrollTo","userPhone","axios","get","params","phone","then","res","data","result","length","setState","post","houseArr","storyArr","this","className","style","display","src","alt","initialPage","xunyuansub","tabBarActiveTextColor","renderTab","tab","onTabClick","onChange","map","h","i","key","onClick","picture_url","price","s","j","_id","cover_image_url","localized_article_location","published_at_human_readable","Component","module","exports","createHashHistory","defaults","baseURL","headers","common","Modal","alert","interceptors","request","use","config","token","error","Promise","reject","response","setTimeout","msg","code"],"mappings":"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","file":"static/js/15.47a1d202.chunk.js","sourcesContent":["import \"./index.scss\";\r\nconst img = require(\"../../../assets/xinyuandan.jpg\");\r\nimport {Tabs} from \"antd-mobile\";\r\nimport {axios} from \"&/axios\";\r\nimport {history} from \"&/history\";\r\n\r\nexport default class Xinyuandan extends Component{\r\n    constructor(){\r\n        super();\r\n        this.state = {\r\n            tabs:[\r\n                { title: '房源', name:'house', sub: '0' },\r\n                { title: '故事', name:'story', sub: '1' }\r\n            ],\r\n            housesId:[],\r\n            storiesId:[],\r\n            houses:[],\r\n            stories:[],\r\n            show:false,\r\n            msgShow:false\r\n        }\r\n    }\r\n    componentDidMount(){\r\n        scrollTo(0, 0);\r\n        if(sessionStorage.userPhone){\r\n            axios.get(\"/airbnb/userstars\",{\r\n                params:{\r\n                    phone:sessionStorage.userPhone\r\n                }\r\n            }).then(res=>{\r\n                    if(res.data.result.stories.length || res.data.result.houses.length){\r\n                        this.setState({\r\n                            msgShow:true\r\n                        })\r\n                    }else{\r\n                        this.setState({\r\n                            show:true\r\n                        })\r\n                    }\r\n                    this.setState({\r\n                        storiesId:res.data.result.stories,\r\n                        housesId:res.data.result.houses\r\n                    })\r\n                    axios.post(\"/airbnb/userhouse\",{\r\n                        houseArr:this.state.housesId\r\n                    }).then(res=>{\r\n                        this.setState({\r\n                            houses:res.data.result\r\n                        })\r\n                    })\r\n                    axios.post(\"/airbnb/userstory\",{\r\n                        storyArr:this.state.storiesId\r\n                    }).then(res=>{\r\n                        this.setState({\r\n                            stories:res.data.result\r\n                        })\r\n                    })\r\n            })\r\n        }else{\r\n            this.setState({\r\n                show:true\r\n            })\r\n        }\r\n    }\r\n    goHouse=id=>{\r\n        sessionStorage.houseid = id;\r\n        history.push(\"/housedetail\");\r\n    }\r\n    goStory=id=>{\r\n        sessionStorage.storyid = id;\r\n        history.push(\"/storydetail\");\r\n    }\r\n    render(){\r\n        const {\r\n            tabs,\r\n            show,\r\n            msgShow,\r\n            houses,\r\n            stories\r\n        } = this.state;\r\n        return (\r\n            <div className=\"xinyuandan\">\r\n                <div className=\"em_hd\">\r\n                    <h2>心愿单</h2>\r\n                    <p>轻点心形图标收藏住宿和体验活动。</p>\r\n                </div>\r\n                <div className=\"empty\" style={{display:show?\"\":\"none\"}}>\r\n                    <div className=\"em_img\">\r\n                        <img src={img} alt=\"\"/>\r\n                    </div>\r\n                </div>\r\n                <div className=\"fill\" style={{display:msgShow?\"\":\"none\"}}>\r\n                    <Tabs tabs={tabs}\r\n                        initialPage={sessionStorage.xunyuansub * 1}\r\n                        tabBarActiveTextColor=\"#008489\"\r\n                        renderTab={tab => <span>{tab.title}</span>}\r\n                        onTabClick={tab=> sessionStorage.xunyuansub = tab.sub}\r\n                        onChange={tab=> sessionStorage.xunyuansub = tab.sub}\r\n                        >\r\n                        <ul className=\"clbox\">\r\n                            {\r\n                                houses.map((h,i)=>{\r\n                                    return(\r\n                                        <li key={i} onClick={()=>{this.goHouse(h.id)}}>\r\n                                            <div className=\"climg\">\r\n                                                <img src={h.picture_url} alt=\"\"/>\r\n                                            </div>\r\n                                            <div className=\"cltxt\">\r\n                                                <h2>{h.name}</h2>\r\n                                                <p><span>{h.price}</span>/晚</p>\r\n                                            </div>\r\n                                        </li>\r\n                                    )\r\n                                })\r\n                            }\r\n                        </ul>\r\n                        <ul className=\"clbox\">\r\n                            {\r\n                                stories.map((s,j)=>{\r\n                                    return(\r\n                                        <li key={j} onClick={()=>{this.goStory(s._id)}}>\r\n                                            <div className=\"climg\">\r\n                                                <img src={s.cover_image_url} alt=\"\"/>\r\n                                            </div>\r\n                                            <div className=\"cltxt\">\r\n                                                <h2>{s.title}</h2>\r\n                                                <p><span>{s.localized_article_location}</span>{s.published_at_human_readable}</p>\r\n                                            </div>\r\n                                        </li>\r\n                                    )\r\n                                })\r\n                            }\r\n                        </ul>\r\n                    </Tabs>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","module.exports = __webpack_public_path__ + \"static/media/xinyuandan.c902444c.jpg\";","import {createHashHistory} from \"history\";\r\n\r\nconst history = new createHashHistory();\r\n\r\nexport {history};","\r\n\r\n\r\nimport axios from \"axios\";\r\n\r\n// axios.defaults.baseURL = \"http://localhost:2019/\";\r\naxios.defaults.baseURL = \"https://arthasic.top:6918\";\r\n\r\n\r\nlet token = \"\";\r\naxios.defaults.headers.common['token'] = token;    // token \r\naxios.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded';\r\n\r\nimport {Toast,Modal } from \"antd-mobile\"\r\nimport {history} from \"./history\"\r\n\r\nconst alert = Modal.alert;\r\nconst showAlert = () => {\r\n    const alertInstance = alert('登录提示', '你确定是否前往登陆', [\r\n      { text: '我就看看', onPress: () => console.log('游客访问'), style: 'default' },\r\n      { text: '马上登录', onPress: () => history.push(\"/login\") },\r\n    ]);\r\n    setTimeout(() => {\r\n      // 可以调用close方法以在外部close\r\n      console.log('auto close');\r\n      alertInstance.close();\r\n    }, 500000);\r\n};\r\n\r\nexport function loadingToast(msg) {\r\n    // Toast.hide();\r\n    // Toast.loading(msg, 1, () => {\r\n    //   console.log('Load complete !!!');\r\n    // });\r\n}\r\n\r\nexport function failToast(msg) {\r\n    // Toast.hide();\r\n    // Toast.fail(msg, 1);\r\n}\r\n\r\nexport function showToast(msg) {\r\n    // Toast.hide();\r\n    // Toast.info(msg, 1);\r\n}\r\n\r\n// 拦截器配置    Interceptors \r\n// 发送请求之前 添加拦截器  \r\naxios.interceptors.request.use(function (config) {\r\n    // 发送之前做的事情 \r\n    // loadingToast(\"请求中\");\r\n    config.headers['token'] =  sessionStorage.token;\r\n    // console.log(config);\r\n\r\n    return config;\r\n}, function (error) {\r\n    // 发送失败 做的失败 \r\n    // failToast(\"请求失败\")\r\n    return Promise.reject(error);\r\n});\r\n\r\n// 响应数据 的拦截器 \r\naxios.interceptors.response.use(function (response) {\r\n    // 成功接收到数据 \r\n    // console.log(response);\r\n    setTimeout(()=>{\r\n        showToast(response.data.msg);\r\n        if(response.data.code==500){\r\n            // showAlert();\r\n        }\r\n    },500)\r\n    return response;\r\n}, function (error) {\r\n    // failToast(\"响应失败\");\r\n    // 无法接收到数据  \r\n    return Promise.reject(error);\r\n});\r\n\r\n\r\nexport  {axios};\r\n\r\n"],"sourceRoot":""}