{"version":3,"sources":["scripts/views/chat/index.js","utils/history.js","utils/axios.js"],"names":["Chat","trans","setState","goback","history","go","toOrder","sessionStorage","se","push","state","houseid","detail","banner","toggle","order","scrollTo","axios","post","id","this","then","res","data","result","picture_urls","slice","setTimeout","get","params","phone","userPhone","orders","endorder","forEach","item","i","topay","className","onClick","src","pic","alt","name","price","day","style","display","Component","createHashHistory","defaults","baseURL","headers","common","Modal","alert","interceptors","request","use","config","token","error","Promise","reject","response","msg","code"],"mappings":"8PAIqBA,E,YACjB,aAAc,IAAD,8BACT,+CAUJC,MAAM,WACF,EAAKC,SAAS,CACVD,OAAO,KAbF,EAgBbE,OAAO,WACHC,IAAQC,IAAI,IAjBH,EAmBbC,QAAQ,WACJC,eAAeC,GAAK,MACpBJ,IAAQK,KAAK,iBAnBb,EAAKC,MAAQ,CACTC,QAAQJ,eAAeI,QACvBC,OAAO,GACPC,OAAO,GACPC,QAAO,EACPC,MAAM,GACNd,OAAM,GARD,E,iFAuBO,IAAD,OACfe,SAAS,EAAG,GACZC,IAAMC,KAAK,sBAAsB,CAC7BC,GAAGC,KAAKV,MAAMC,UACfU,MAAK,SAAAC,GACJ,EAAKpB,SAAS,CACVU,OAAOU,EAAIC,KAAKC,OAChBX,OAAOS,EAAIC,KAAKC,OAAOC,aAAaC,MAAM,EAAE,KAEhDC,YAAW,WACP,EAAKzB,SAAS,CACVY,QAAO,MAEb,QAENG,IAAMW,IAAI,gBAAgB,CACtBC,OAAO,CACHC,MAAMvB,eAAewB,aAE1BV,MAAK,SAAAC,GACJ,IAAIU,EAASV,EAAIC,KAAKC,OAAOS,SACzBlB,EAAQ,GACZiB,EAAOE,SAAQ,SAACC,EAAMC,GACfD,EAAKxB,SAAWJ,eAAeI,SAC9BI,EAAMN,KAAK0B,MAGnB,EAAKjC,SAAS,CACVa,MAAMA,EAAM,GACZsB,OAAM,S,+BAIT,IAAD,SAKAjB,KAAKV,MAHLC,EAFA,EAEAA,QACAI,EAHA,EAGAA,MACAd,EAJA,EAIAA,MAEJ,OACI,uBAAKqC,UAAU,QACX,uBAAKA,UAAU,WACX,uBAAKA,UAAU,aACX,qBAAGA,UAAU,qBAAqBC,QAASnB,KAAKjB,UAEpD,uBAAKmC,UAAU,aAAaC,QAAS,kBAAI,EAAKjC,QAAQK,KAClD,uBAAK6B,IAAKzB,EAAM0B,IAAKC,IAAI,KACzB,uBAAKJ,UAAU,YACX,0BAAKvB,EAAM4B,MACX,0BAAI,kDAAJ,0BAA0B5B,EAAM6B,MAAQ7B,EAAM8B,QAI1D,uBAAKP,UAAU,WACX,0BACI,sBAAIQ,MAAO,CAACC,QAAQ9C,EAAM,OAAO,KAC7B,yGACA,8CACA,mHACA,8EACA,+DACA,+GACA,oEACA,4JACA,yHACA,0DAEJ,sBAAI6C,MAAO,CAACC,QAAQ9C,EAAM,GAAG,SACzB,yIACA,uEACA,2LACA,6GACA,4GACA,sMACA,2FACA,kOACA,+KACA,mGAIZ,0BAAQ6C,MAAO,CAACC,QAAQ9C,EAAM,OAAO,IAAKsC,QAASnB,KAAKnB,OAAxD,yD,GAzGkB+C,I,gECJlC,sCAEM5C,EAAU,IAFhB,KAEoB6C,I,gCCCpB,2EAGAhC,IAAMiC,SAASC,QAAU,4BAIzBlC,IAAMiC,SAASE,QAAQC,OAAvB,MADY,GAEZpC,IAAMiC,SAASE,QAAQlC,KAAK,gBAAkB,oCAKhCoC,IAAMC,MAgCpBtC,IAAMuC,aAAaC,QAAQC,KAAI,SAAUC,GAMrC,OAHAA,EAAOP,QAAP,MAA2B7C,eAAeqD,MAGnCD,KACR,SAAUE,GAGT,OAAOC,QAAQC,OAAOF,MAI1B5C,IAAMuC,aAAaQ,SAASN,KAAI,SAAUM,GAStC,OANArC,YAAW,WACGqC,EAASzC,KAAK0C,IACrBD,EAASzC,KAAK2C,OAGnB,KACKF,KACR,SAAUH,GAGT,OAAOC,QAAQC,OAAOF","file":"static/js/18.b2f48c28.chunk.js","sourcesContent":["import \"./index.scss\";\r\nimport {axios} from \"&/axios\";\r\nimport {history} from \"&/history\";\r\n\r\nexport default class Chat extends Component{\r\n    constructor(){\r\n        super();\r\n        this.state = {\r\n            houseid:sessionStorage.houseid,\r\n            detail:[],\r\n            banner:[],\r\n            toggle:false,\r\n            order:[],\r\n            trans:false\r\n        }\r\n    }\r\n    trans=()=>{\r\n        this.setState({\r\n            trans: true\r\n        })\r\n    }\r\n    goback=()=>{\r\n        history.go(-1);\r\n    }\r\n    toOrder=()=>{\r\n        sessionStorage.se = \"end\";\r\n        history.push(\"/orderdetail\");\r\n    }\r\n    componentDidMount(){\r\n        scrollTo(0, 0);\r\n        axios.post(\"/airbnb/housedetail\",{\r\n            id:this.state.houseid\r\n        }).then(res=>{\r\n            this.setState({\r\n                detail:res.data.result,\r\n                banner:res.data.result.picture_urls.slice(0,5),\r\n            })\r\n            setTimeout(()=>{\r\n                this.setState({\r\n                    toggle:true\r\n                })\r\n            },500)\r\n        });\r\n        axios.get(\"/airbnb/order\",{\r\n            params:{\r\n                phone:sessionStorage.userPhone\r\n            }\r\n        }).then(res=>{\r\n            var orders = res.data.result.endorder;\r\n            var order = [];\r\n            orders.forEach((item, i) => {\r\n                if(item.houseid == sessionStorage.houseid){\r\n                    order.push(item);\r\n                }\r\n            });\r\n            this.setState({\r\n                order:order[0],\r\n                topay:false\r\n            })\r\n        })\r\n    }\r\n    render(){\r\n        const {\r\n            houseid,\r\n            order,\r\n            trans\r\n        } = this.state;\r\n        return(\r\n            <div className=\"chat\">\r\n                <div className=\"chat_hd\">\r\n                    <div className=\"chat_back\">\r\n                        <i className=\"iconfont icon-back\" onClick={this.goback}></i>\r\n                    </div>\r\n                    <div className=\"chat_order\" onClick={()=>this.toOrder(houseid)}>\r\n                        <img src={order.pic} alt=\"\"/>\r\n                        <div className=\"chat_tit\">\r\n                            <h2>{order.name}</h2>\r\n                            <h2><span>已确认</span>·总价 ￥{order.price * order.day}</h2>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div className=\"chat_bd\">\r\n                    <ul>\r\n                        <li style={{display:trans?\"none\":\"\"}}>\r\n                            <p>Thank you for your reservation. Please read the information below carefully.</p>\r\n                            <p>BASIC ROOM RULES:</p>\r\n                            <p>1. Please tell us your check in time. If this changes, please let us know in advance. </p>\r\n                            <p>2. No smoking in or anywhere around the building.</p>\r\n                            <p>3. Check in: Any time after 15.00.</p>\r\n                            <p>4. Check out:  Strictly 10.00 a.m. No late check out (half night penalties apply).</p>\r\n                            <p>5. No luggage storage after check out. </p>\r\n                            <p>6. Please be quiet around the room after 20.00 and try not to roll your suitcases loudly as you approach the room if possible. </p>\r\n                            <p>7. The host telephone number is in the directions document. Please call in emergencies only.</p>\r\n                            <p>We will contact you again:-)</p>\r\n                        </li>\r\n                        <li style={{display:trans?\"\":\"none\"}}>\r\n                            <p>谢谢您的预定。请仔细阅读下面的信息。</p>\r\n                            <p>基本房间规则：</p>\r\n                            <p>1.请告诉我们您的入住时间。如果有变化，请提前通知我们。</p>\r\n                            <p>2.禁止在建筑物内或周围吸烟。</p>\r\n                            <p>3.登记入住：15:00后的任何时间。</p>\r\n                            <p>4.退房：严格执行上午10:00退房，不得延迟退房（适用半晚罚款）。</p>\r\n                            <p>5.退房后没有行李寄存。</p>\r\n                            <p>6.20点后，请在房间周围保持安静，尽量不要在靠近房间时大声翻动手提箱。 </p>\r\n                            <p>7.主机电话号码在说明书上。请只在紧急情况下打电话。</p>\r\n                            <p>我们将再次与您联系：-）</p>\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n                <button style={{display:trans?\"none\":\"\"}} onClick={this.trans}>将此消息译成中文</button>\r\n            </div>\r\n        )\r\n    }\r\n}","import {createHashHistory} from \"history\";\r\n\r\nconst history = new createHashHistory();\r\n\r\nexport {history};","\r\n\r\n\r\nimport axios from \"axios\";\r\n\r\n// axios.defaults.baseURL = \"http://localhost:2019/\";\r\naxios.defaults.baseURL = \"https://arthasic.top:6918\";\r\n\r\n\r\nlet token = \"\";\r\naxios.defaults.headers.common['token'] = token;    // token \r\naxios.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded';\r\n\r\nimport {Toast,Modal } from \"antd-mobile\"\r\nimport {history} from \"./history\"\r\n\r\nconst alert = Modal.alert;\r\nconst showAlert = () => {\r\n    const alertInstance = alert('登录提示', '你确定是否前往登陆', [\r\n      { text: '我就看看', onPress: () => console.log('游客访问'), style: 'default' },\r\n      { text: '马上登录', onPress: () => history.push(\"/login\") },\r\n    ]);\r\n    setTimeout(() => {\r\n      // 可以调用close方法以在外部close\r\n      console.log('auto close');\r\n      alertInstance.close();\r\n    }, 500000);\r\n};\r\n\r\nexport function loadingToast(msg) {\r\n    // Toast.hide();\r\n    // Toast.loading(msg, 1, () => {\r\n    //   console.log('Load complete !!!');\r\n    // });\r\n}\r\n\r\nexport function failToast(msg) {\r\n    // Toast.hide();\r\n    // Toast.fail(msg, 1);\r\n}\r\n\r\nexport function showToast(msg) {\r\n    // Toast.hide();\r\n    // Toast.info(msg, 1);\r\n}\r\n\r\n// 拦截器配置    Interceptors \r\n// 发送请求之前 添加拦截器  \r\naxios.interceptors.request.use(function (config) {\r\n    // 发送之前做的事情 \r\n    // loadingToast(\"请求中\");\r\n    config.headers['token'] =  sessionStorage.token;\r\n    // console.log(config);\r\n\r\n    return config;\r\n}, function (error) {\r\n    // 发送失败 做的失败 \r\n    // failToast(\"请求失败\")\r\n    return Promise.reject(error);\r\n});\r\n\r\n// 响应数据 的拦截器 \r\naxios.interceptors.response.use(function (response) {\r\n    // 成功接收到数据 \r\n    // console.log(response);\r\n    setTimeout(()=>{\r\n        showToast(response.data.msg);\r\n        if(response.data.code==500){\r\n            // showAlert();\r\n        }\r\n    },500)\r\n    return response;\r\n}, function (error) {\r\n    // failToast(\"响应失败\");\r\n    // 无法接收到数据  \r\n    return Promise.reject(error);\r\n});\r\n\r\n\r\nexport  {axios};\r\n\r\n"],"sourceRoot":""}