(window.webpackJsonpairbnb=window.webpackJsonpairbnb||[]).push([[13],{271:function(e,t,n){},63:function(e,t,n){"use strict";n.r(t),function(e,s){n.d(t,"default",(function(){return m}));var r=n(10),a=n(12),o=n(14),i=n(13),u=n(15),c=(n(271),n(75)),l=n(77),d=n(79),f=(n(83),d.f.alert),g=function(){f("\u60a8\u8fd8\u6ca1\u6709\u767b\u5f55","\u662f\u5426\u524d\u5f80\u767b\u5f55\u9875\u9762",[{text:"\u7ee7\u7eed\u6d4f\u89c8",onPress:function(){return console.log("\u672a\u767b\u5f55")},style:"default"},{text:"\u524d\u5f80\u767b\u5f55",onPress:function(){return c.a.push("/login")}}])},m=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(o.a)(this,Object(i.a)(t).call(this))).goback=function(){sessionStorage.storytype=e.state.detail.article_category,c.a.go(-1)},e.showXinyuan=function(){f("\u6536\u85cf\u6210\u529f","\u662f\u5426\u524d\u5f80\u5fc3\u613f\u5355",[{text:"\u7ee7\u7eed\u6d4f\u89c8",onPress:function(){return console.log("")},style:"default"},{text:"\u67e5\u770b\u5fc3\u613f",onPress:function(){return e.goXinyuan()}}])},e.goXinyuan=function(){sessionStorage.xunyuansub=1,c.a.push("/index/xinyuandan")},e.likeStory=function(t,n){sessionStorage.userPhone?(e.state.like_users.push(sessionStorage.userPhone),e.setState({like_users:e.state.like_users}),l.a.post("/airbnb/likestory",{id:t,phoneArr:e.state.like_users,count:++n}).then((function(t){e.setState({toggle:!0})}))):g()},e.cancelLikeStory=function(t,n){var s=e.state.like_users,r=s.indexOf(sessionStorage.userPhone);s.splice(r,1),l.a.post("/airbnb/cancellikestory",{id:t,phoneArr:s,count:--n}).then((function(t){e.setState({toggle:!1})}))},e.starStory=function(t){if(sessionStorage.userPhone){var n=e.state.userstarstory;n.push(t),l.a.post("/airbnb/starstory",{phone:sessionStorage.userPhone,storyArr:n}).then((function(t){e.setState({star:!0}),e.showXinyuan()}))}else g()},e.cancelStarStory=function(t){var n=e.state.userstarstory,s=n.indexOf(t);n.splice(s,1),l.a.post("/airbnb/starstory",{phone:sessionStorage.userPhone,storyArr:n}).then((function(t){e.setState({star:!1})}))},e.state={storyid:sessionStorage.storyid,detail:[],author:[],like_users:[],toggle:!1,userstarstory:[],star:!1},e}return Object(u.a)(t,e),Object(a.a)(t,[{key:"componentDidMount",value:function(){var e=this;scrollTo(0,0),l.a.post("/airbnb/storydetail",{id:this.state.storyid}).then((function(t){e.setState({detail:t.data.result,author:t.data.result.author_object}),t.data.result.like_user&&(e.setState({like_users:t.data.result.like_user}),sessionStorage.userPhone&&-1!=e.state.like_users.indexOf(sessionStorage.userPhone)&&e.setState({toggle:!0}))})),sessionStorage.userPhone&&l.a.get("/airbnb/userstars",{params:{phone:sessionStorage.userPhone}}).then((function(t){e.setState({userstarstory:t.data.result.stories}),-1!=t.data.result.stories.indexOf(sessionStorage.storyid)&&e.setState({star:!0})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.detail,r=t.author,a=t.toggle,o=t.star;return s.createElement("div",{className:"story_detail"},s.createElement("div",{className:"story_hd"},s.createElement("i",{className:"iconfont icon-back",onClick:this.goback})),s.createElement("div",{className:"story_bd"},s.createElement("div",{className:"story_msg"},s.createElement("img",{src:r.picture_url&&r.picture_url.substring(0,r.picture_url.indexOf("?")),alt:""}),s.createElement("div",{className:"comment_user"},s.createElement("h5",null,r.first_name),s.createElement("span",null,n.localized_article_location),s.createElement("span",null,n.published_at_human_readable))),s.createElement("div",{className:"story_content"},s.createElement("img",{src:n.cover_image_url&&n.cover_image_url.substring(0,n.cover_image_url.indexOf("?")),alt:""}),s.createElement("h2",null,n.title),s.createElement("p",null,n.email_subtitle)),s.createElement("div",{className:"story_menu"},s.createElement("div",{onClick:a?function(){return e.cancelLikeStory(n._id,n.like_count)}:function(){return e.likeStory(n._id,n.like_count)},style:{background:a?"rgb(255, 90, 95, 0.8)":""}},s.createElement("i",{style:{color:a?"#fff":""},className:"iconfont icon-dianzan"})),s.createElement("div",{onClick:o?function(){return e.cancelStarStory(n._id)}:function(){return e.starStory(n._id)},style:{background:o?"rgb(255, 90, 95, 0.8)":""}},s.createElement("i",{style:{color:o?"#fff":""},className:"iconfont icon-heart2e"}))),s.createElement("div",{className:"story_ft"},s.createElement("h2",null,"\u70b9\u8d5e"),s.createElement("h2",null,"\u6536\u85cf"))))}}]),t}(e)}.call(this,n(0).Component,n(0))},75:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var s=new(n(8).a)},77:function(e,t,n){"use strict";var s=n(78),r=n.n(s);n.d(t,"a",(function(){return r.a}));var a=n(79);n(75);r.a.defaults.baseURL="https://arthasic.top:6918";r.a.defaults.headers.common.token="",r.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded";a.f.alert;r.a.interceptors.request.use((function(e){return e.headers.token=sessionStorage.token,e}),(function(e){return Promise.reject(e)})),r.a.interceptors.response.use((function(e){return setTimeout((function(){e.data.msg,e.data.code}),500),e}),(function(e){return Promise.reject(e)}))},83:function(e,t,n){"use strict";var s,r,a,o,i=n(99),u=n(10),c=n(100),l=(n(101),n(80)),d=(s=function e(){Object(u.a)(this,e),Object(i.a)(this,"msgtoggle",r,this),Object(i.a)(this,"msgRead",a,this),Object(i.a)(this,"msgSend",o,this)},r=Object(c.a)(s.prototype,"msgtoggle",[l.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),a=Object(c.a)(s.prototype,"msgRead",[l.d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.msgtoggle=!1}}}),o=Object(c.a)(s.prototype,"msgSend",[l.d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.msgtoggle=!0}}}),s);t.a=new d}}]);
//# sourceMappingURL=13.b5ad014a.chunk.js.map