{"version":3,"sources":["scripts/views/order/index.js","utils/history.js","utils/axios.js"],"names":["Order","goback","history","push","goHome","goDetail","id","se","sessionStorage","houseid","state","tabs","title","name","sub","startorder","endorder","noorder","hasorder","scrollTo","userPhone","axios","get","params","phone","then","res","data","result","length","setState","this","className","onClick","style","display","initialPage","tabBarActiveTextColor","tabBarTextStyle","fontSize","renderTab","tab","map","e","i","key","start","end","day","color","price","src","pic","alt","s","j","Component","createHashHistory","defaults","baseURL","headers","common","post","Modal","alert","interceptors","request","use","config","token","error","Promise","reject","response","setTimeout","msg","code"],"mappings":"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","file":"static/js/20.7359f31b.chunk.js","sourcesContent":["import \"./index.scss\";\r\nimport {Tabs} from \"antd-mobile\";\r\nimport {history} from \"&/history\";\r\nimport {axios} from \"&/axios\";\r\n\r\nexport default class Order extends Component{\r\n    constructor(){\r\n        super();\r\n        this.state = {\r\n            tabs:[\r\n                { title: '全部订单', name:'quanbu', sub: '0' },\r\n                { title: '有效订单', name:'youxiao', sub: '1' },\r\n                { title: '待支付订单', name:'zhifu', sub: '2' }\r\n            ],\r\n            startorder:[],\r\n            endorder:[],\r\n            noorder:false,\r\n            hasorder:false\r\n        }\r\n    }\r\n    goback=()=>{\r\n        history.push(\"/index/wode\");\r\n    }\r\n    goHome=()=>{\r\n        history.push(\"/index/tansuo\");\r\n    }\r\n    goDetail=(id,se)=>{\r\n        sessionStorage.houseid = id;\r\n        sessionStorage.se = se;\r\n        history.push(\"/orderdetail\");\r\n    }\r\n    componentDidMount(){\r\n        scrollTo(0, 0);\r\n        if(sessionStorage.userPhone){\r\n            axios.get(\"/airbnb/order\",{\r\n                params:{\r\n                    phone:sessionStorage.userPhone\r\n                }\r\n            }).then(res=>{\r\n                if(res.data.result){\r\n                    if(!res.data.result.startorder.length && !res.data.result.endorder.length){\r\n                        this.setState({\r\n                            noorder:true\r\n                        })\r\n                    }else{\r\n                        this.setState({\r\n                            startorder: res.data.result.startorder,\r\n                            endorder: res.data.result.endorder,\r\n                            hasorder: true\r\n                        })\r\n                    }\r\n                }else{\r\n                    this.setState({\r\n                        noorder:true\r\n                    })\r\n                }\r\n            })\r\n        }\r\n    }\r\n    render(){\r\n        const {\r\n            tabs,\r\n            startorder,\r\n            endorder,\r\n            noorder,\r\n            hasorder\r\n        } = this.state;\r\n        return (\r\n            <div className=\"order\">\r\n                <div className=\"order_hd\">\r\n                    <i className=\"iconfont icon-back\" onClick={this.goback}></i>\r\n                    <h2>订单中心</h2>\r\n                </div>\r\n                <div className=\"noorder\" style={{display:noorder?\"\":\"none\"}}>\r\n                    <h2>您还没有预订过房源<br/>点击「开始探索」开启下一段旅程吧</h2>\r\n                    <p onClick={this.goHome}>开始探索</p>\r\n                </div>\r\n                <div className=\"order_bd\" style={{display:hasorder?\"\":\"none\"}}>\r\n                    <Tabs tabs={tabs}\r\n                        initialPage={sessionStorage.sub * 1}\r\n                        tabBarActiveTextColor=\"#008489\"\r\n                        tabBarTextStyle={{fontSize:\"0.28rem\"}}\r\n                        renderTab={tab => <span>{tab.title}</span>}\r\n                        >\r\n                        <ul className=\"orderbox\">\r\n                            {\r\n                                endorder.map((e,i)=>{\r\n                                    return(\r\n                                        <li key={i} onClick={()=>this.goDetail(e.houseid,\"end\")}>\r\n                                            <div className=\"ordertxt\">\r\n                                                <h2>{e.name}</h2>\r\n                                                <p>{e.start}至{e.end}·{e.day}晚</p>\r\n                                                <p><span style={{color: \"#91D399\"}}>订单已确认</span>￥{e.price * e.day}</p>\r\n                                            </div>\r\n                                            <div className=\"orderimg\">\r\n                                                <img src={e.pic} alt=\"\"/>\r\n                                            </div>\r\n                                        </li>\r\n                                    )\r\n                                })\r\n                            }\r\n                            {\r\n                                startorder.map((s,j)=>{\r\n                                    return(\r\n                                        <li key={j} onClick={()=>this.goDetail(s.houseid,\"start\")}>\r\n                                            <div className=\"ordertxt\">\r\n                                                <h2>{s.name}</h2>\r\n                                                <p>{s.start}至{s.end}·{s.day}晚</p>\r\n                                                <p><span style={{color: \"#FF5A5F\"}}>订单待支付</span>￥{s.price * s.day}</p>\r\n                                            </div>\r\n                                            <div className=\"orderimg\">\r\n                                                <img src={s.pic} alt=\"\"/>\r\n                                            </div>\r\n                                        </li>\r\n                                    )\r\n                                })\r\n                            }\r\n                        </ul>\r\n                        <ul className=\"orderbox\">\r\n                            {\r\n                                endorder.map((e,i)=>{\r\n                                    return(\r\n                                        <li key={i} onClick={()=>this.goDetail(e.houseid,\"end\")}>\r\n                                            <div className=\"ordertxt\">\r\n                                                <h2>{e.name}</h2>\r\n                                                <p>{e.start}至{e.end}·{e.day}晚</p>\r\n                                                <p><span style={{color: \"#91D399\"}}>订单已确认</span>￥{e.price * e.day}</p>\r\n                                            </div>\r\n                                            <div className=\"orderimg\">\r\n                                                <img src={e.pic} alt=\"\"/>\r\n                                            </div>\r\n                                        </li>\r\n                                    )\r\n                                })\r\n                            }\r\n                        </ul>\r\n                        <ul className=\"orderbox\">\r\n                            {\r\n                                startorder.map((s,j)=>{\r\n                                    return(\r\n                                        <li key={j} onClick={()=>this.goDetail(s.houseid,\"start\")}>\r\n                                            <div className=\"ordertxt\">\r\n                                                <h2>{s.name}</h2>\r\n                                                <p>{s.start}至{s.end}·{s.day}晚</p>\r\n                                                <p><span style={{color: \"#FF5A5F\"}}>订单待支付</span>￥{s.price * s.day}</p>\r\n                                            </div>\r\n                                            <div className=\"orderimg\">\r\n                                                <img src={s.pic} alt=\"\"/>\r\n                                            </div>\r\n                                        </li>\r\n                                    )\r\n                                })\r\n                            }\r\n                        </ul>\r\n                    </Tabs>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}","import {createHashHistory} from \"history\";\r\n\r\nconst history = new createHashHistory();\r\n\r\nexport {history};","\r\n\r\n\r\nimport axios from \"axios\";\r\n\r\n// axios.defaults.baseURL = \"http://localhost:2019/\";\r\naxios.defaults.baseURL = \"https://arthasic.top:6918\";\r\n\r\n\r\nlet token = \"\";\r\naxios.defaults.headers.common['token'] = token;    // token \r\naxios.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded';\r\n\r\nimport {Toast,Modal } from \"antd-mobile\"\r\nimport {history} from \"./history\"\r\n\r\nconst alert = Modal.alert;\r\nconst showAlert = () => {\r\n    const alertInstance = alert('登录提示', '你确定是否前往登陆', [\r\n      { text: '我就看看', onPress: () => console.log('游客访问'), style: 'default' },\r\n      { text: '马上登录', onPress: () => history.push(\"/login\") },\r\n    ]);\r\n    setTimeout(() => {\r\n      // 可以调用close方法以在外部close\r\n      console.log('auto close');\r\n      alertInstance.close();\r\n    }, 500000);\r\n};\r\n\r\nexport function loadingToast(msg) {\r\n    // Toast.hide();\r\n    // Toast.loading(msg, 1, () => {\r\n    //   console.log('Load complete !!!');\r\n    // });\r\n}\r\n\r\nexport function failToast(msg) {\r\n    // Toast.hide();\r\n    // Toast.fail(msg, 1);\r\n}\r\n\r\nexport function showToast(msg) {\r\n    // Toast.hide();\r\n    // Toast.info(msg, 1);\r\n}\r\n\r\n// 拦截器配置    Interceptors \r\n// 发送请求之前 添加拦截器  \r\naxios.interceptors.request.use(function (config) {\r\n    // 发送之前做的事情 \r\n    // loadingToast(\"请求中\");\r\n    config.headers['token'] =  sessionStorage.token;\r\n    // console.log(config);\r\n\r\n    return config;\r\n}, function (error) {\r\n    // 发送失败 做的失败 \r\n    // failToast(\"请求失败\")\r\n    return Promise.reject(error);\r\n});\r\n\r\n// 响应数据 的拦截器 \r\naxios.interceptors.response.use(function (response) {\r\n    // 成功接收到数据 \r\n    // console.log(response);\r\n    setTimeout(()=>{\r\n        showToast(response.data.msg);\r\n        if(response.data.code==500){\r\n            // showAlert();\r\n        }\r\n    },500)\r\n    return response;\r\n}, function (error) {\r\n    // failToast(\"响应失败\");\r\n    // 无法接收到数据  \r\n    return Promise.reject(error);\r\n});\r\n\r\n\r\nexport  {axios};\r\n\r\n"],"sourceRoot":""}